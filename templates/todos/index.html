<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>To Dos</title>
        <script src="/static/js/jquery-1.4.2.min.js"></script>
        <style>
            body{margin:0;background:#e5ecf4}
            dt{font-size:1.2em;color:#3f3;margin-bottom:1em;text-shadow:0 0 3px #000}
            #hb{position:fixed;top:-50px;-webkit-box-shadow:0 2px 5px #66f;
                -webkit-transition:top 0.4s ease-in-out
            }
            .il{background:url(/static/todos/il.jpg) no-repeat}
            .im{background:url(/static/todos/im.jpg)}
            .ir{background:url(/static/todos/ir.jpg) no-repeat}
            .hbf .il{background:url(/static/todos/ifl.jpg) no-repeat}
            .hbf .im{background:url(/static/todos/ifm.jpg)}
            .hbf .ir{background:url(/static/todos/ifr.jpg) no-repeat}
            #ntd{width:100%;height:1em;font-size:1em;background:transparent;color:white;outline:0;border:none}
            #ld{background:url(/static/todos/loading.gif) repeat-x bottom rgba(0,0,0,0.5);border:solid 5px #fff;position:fixed;top:100px;left:10px;right:10px;color:white;text-shadow:1px 1px 1px #000;padding:1.5em 10px;-webkit-box-shadow:0 0 3px #000;-webkit-transition:opacity 0.4s ease-in-out;opacity:1;z-index:102}
            .tdl{list-style:none;padding:10px;display:none}
            #todo{margin-top:80px}
            .tdl li{background:url(/static/todos/hlt.png) right center no-repeat,url(/static/todos/nd.png) 10px center no-repeat #fff;padding:0.5em 40px;-webkit-border-radius:1.5em;border:solid 4px #999;color:#333;margin:5px 0}
            #done li{background:url(/static/todos/d.png) 10px center no-repeat #fff}
            .tdl li div{overflow:hidden;white-space:nowrap} 
            .hilt{background:url(/static/todos/hled.png) right center no-repeat,url(/static/todos/d.png) 10px center no-repeat #fff}
            #drop{
                position:absolute;width:100%;
                right:0;left:0;padding:10px;z-index:100;
                background:rgba(255,255,255,0.9);-webkit-box-shadow:0 0 2px #000;
            }
            #drop td{padding:10px;}
            #img{display:block;position:absolute;margin-top:-10px;left:50%;margin-left:-10px;z-index:101}
            #tdo{border:solid 1px #ccc}
            #done li{opacity:0.4}
            #done li div{text-decoration:line-through}
            
        </style>
    </head>
    <body>
        <table cellspacing='0' width="100%" id="hb">
            <tr width="100%" height="50">
                <td width="18" class='il'></td>
                <td class='im'>
                    <input id="ntd"/>
                </td>
                <td width="120" class='ir'></td>
            </tr>
        </table>
        <ul id='todo' class="tdl">
            <dt>To Dos:</dt>
        </ul>
        <ul id="done" class='tdl'>
            <dt>Done:</dt>
            <li>
            	<div>已经完成的任务</div>
            </li>
        </ul>
        <div id="ld">
            正在加载中 Loading...
        </div>
        <table id="drop" cellspacing="0" style="display:none">
            <tr>
                <td colspan="4" id="tdo">
                    test
                </td>
            </tr>
            <tr align="center">
                <td>
                    <a href=""><img src="/static/todos/sr.png" alt="Share" /></a>
                </td>
                <td>
                    <a><img src="/static/todos/done.png" alt="Done" /></a>
                </td>
                <td>
                    <a><img src="/static/todos/hl.png" alt="Highlight" /></a>
                </td>
                <td>
                    <a><img src="/static/todos/del.png" alt="Delete" /></a>
                </td>
            </tr>
        </table>
            <img id="img" src="/static/todos/A.png"style="display:none"/>
        <script type="text/javascript">
            $('#ntd').focus(function(){$('#hb').addClass('hbf')}).blur(function(){$('#hb').removeClass('hbf')});
            $('.il,.im').click(function(){$('#ntd').focus()});
            $('#ld').click(function(){$(this).css({'display':'none'})})
            $(window).load(function(){
                    $('#todo li').live('click',function(e)
                        {
                        $(this).css({'border-color':'#52c3dd'}).attr('loading','true');
                            if(e.pageX<60){alert(1)}
                            else if(e.pageX>($('body').width()-60)){alert(2)}
                            else {
                            $('#tdo').text($(this).text())
                            $('#drop').add('#img').css({'top':($(this).offset()['top']+$(this).height()*3),'display':''}).data('id',$(this).data(id));
                            }
                            return false
                        })
                    $.ajax(
                        {
                            url:'/todos/list',
                            type:'GET',
                            dataType:'text',
                            error:function(){alert('Error Loading Data!')},
                            success:function(data){
                            var obj=eval(data);
                            $.each(obj['ToDos'],
                                function(txt,dt){
                                var lis=$('<li></li>').append($('<div></div>').text(txt)).data('id',dt['id']);
                                if(dt['highlight']) lis.addClass('hilt');
                                $('#todo').append(lis);
                                $('#ld').css({"display":'none'});
                                $('.tdl').css({"display":"block"});
                                $('#hb').css({'top':0});
                                }
                                )
                           }
                        }
                        )
                    }
)
            </script>
        </body>
    </html>
